{{
extend 'layout.html'
}}

<meta name="description" content="Statistics of the VARIA Randomizer and Solver"/>
<link rel="shortcut icon" href={{=URL('static','favicon.ico')}} type="image/ico"/>
<link rel="stylesheet" type="text/css" href={{=URL('static/css','mystyle_20180802.css')}} media="screen"/>
<script type = "text/javascript" src = "https://www.gstatic.com/charts/loader.js"></script>
<script type = "text/javascript">google.charts.load('current', {packages: ['corechart']});</script>

<title>Super Metroid VARIA Randomizer and Solver statistics</title>

<style>
.main {
    margin-bottom: 1em;
}
</style>

<script language = "JavaScript">
function drawCharts() {
  drawSolverPresets();
  drawRandomizerPresets();
  drawSolverDurations();
  drawRandomizerDurations();
}

function drawSolverPresets() {
{{
  if solverPresets == None:
    response.write("  return;", escape=False)
    pass
  else:
}}
    // Define the chart to be drawn.
    var data = google.visualization.arrayToDataTable([
      [{type: 'date', label: 'Date'}, {{response.write(", ".join(["'{}'".format(p) for p in solverPresets[0]]), escape=False)}}]
{{
    maxTick = 0
    for row in solverPresets[1]:
      maxRow = max([int(x) for x in row[1:]])
      if maxRow > maxTick:
        maxTick = maxRow
        pass
      response.write(", [\"Date({}, {}, {})\", {}]".format(row[0].year, row[0].month-1, row[0].day, ", ".join([str(x) for x in row[1:]])), escape=False)
      pass
}}
    ]);

    var options = {
      title: 'presets used to solve each day',
      vAxis: { ticks: {{=range(0, maxTick+1)}} },
      isStacked: true
    };

    // Instantiate and draw the chart.
    var chart = new google.visualization.ColumnChart(document.getElementById("solverPresets"));
    chart.draw(data, options);
{{
    pass
}}
}

function drawRandomizerPresets() {
{{
  if randomizerPresets == None:
    response.write("  return;", escape=False)
    pass
  else:
}}
    // Define the chart to be drawn.
    var data = google.visualization.arrayToDataTable([
    type: 'date', label: 'Date'}, {{response.write(", ".join(["'{}'".format(p) for p in randomizerPresets[0]]), escape=False)}}]
{{
    xTick = 0
    for row in randomizerPresets[1]:
      maxRow = max([int(x) for x in row[1:]])
      if maxRow > maxTick:
        maxTick = maxRow
        pass
      response.write(", [\"Date({}, {}, {})\", {}]".format(row[0].year, row[0].month-1, row[0].day, ", ".join([str(x) for x in row[1:]])), escape=False)
      pass
}}
    ]);

    var options = {
      title: 'presets used to randomize each day',
      vAxis: { ticks: {{=range(0, maxTick+1)}} },
      isStacked: true
    };

    // Instantiate and draw the chart.
    var chart = new google.visualization.ColumnChart(document.getElementById("randomizerPresets"));
    chart.draw(data, options);
{{
    pass
}}
}

function drawSolverDurations() {
{{
  if solverDurations == None:
    response.write("  return;", escape=False)
    pass
  else:
}}
    // Define the chart to be drawn.
    var data = google.visualization.arrayToDataTable([
    [{type: 'date', label: 'Date'}, "Duration"]
{{
    for (date, duration) in solverDurations:
      response.write(", [\"Date({}, {}, {}, {}, {}, {})\", {}]".format(date.year, date.month-1, date.day, date.hour, date.minute, date.second, duration), escape=False)
      pass
}}
    ]);

      var options = {
        title: 'Duration in second of ROMs solved'
      };

      // Instantiate and draw the chart.
      var chart = new google.visualization.ColumnChart(document.getElementById("solverDurations"));
      chart.draw(data, options);
{{
    pass
}}
}

function drawRandomizerDurations() {
{{
  if randomizerDurations == None:
    response.write("  return;", escape=False)
    pass
  else:
}}
    // Define the chart to be drawn.
    var data = google.visualization.arrayToDataTable([
    [{type: 'date', label: 'Date'}, "Duration"]
{{
    for (date, duration) in randomizerDurations:
      response.write(", [\"Date({}, {}, {}, {}, {}, {})\", {}]".format(date.year, date.month-1, date.day, date.hour, date.minute, date.second, duration), escape=False)
      pass
}}
    ]);

    var options = {
      title: 'Duration in second of ROMs generated'
    };

    // Instantiate and draw the chart.
    var chart = new google.visualization.ColumnChart(document.getElementById("randomizerDurations"));
    chart.draw(data, options);
{{
    pass
}}
}

google.charts.setOnLoadCallback(drawCharts);
</script>

<div class="fixed">
  <div class="menu">
    {{=A("Super Metroid VARIA Randomizer and Solver", _href=URL(f="solver"), _class="menu")}}
    {{=A("Presets", _href=URL(f="presets"), _class="menu")}}
    {{=A("Solver", _href=URL(f="solver"), _class="menu")}}
    {{=A("Randomizer", _href=URL(f="randomizer"), _class="menu")}}
    {{=A("Information & Contact", _href=URL(f="infos"), _class="menu")}}
  </div>
</div>

<div class="row">
  <div class="column">
    <h4>Randomizer statistics</h4>
    <div id = "randomizerPresets" style = "width: 550px; height: 400px; margin: 0 auto"></div>
    <div id = "randomizerDurations" style = "width: 550px; height: 400px; margin: 0 auto"></div>
  </div>
  <div class="column">
    <h4>Solver statistics</h4>
    <div id = "solverPresets" style = "width: 550px; height: 400px; margin: 0 auto"></div>
    <div id = "solverDurations" style = "width: 550px; height: 400px; margin: 0 auto"></div>
  </div>
</div>
