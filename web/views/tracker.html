{{
extend 'layout.html'
}}

<meta name="description" content="Solver for the randomized Super Metroid roms"/>
<link rel="shortcut icon" href={{=URL('static','favicon.ico')}} type="image/ico"/>
<link rel="stylesheet" type="text/css" href={{=URL('static','css/mystyle_20180908.css')}} media="screen"/>

<link href={{=URL('static', 'css/bootstrap-tour.min.css')}} rel="stylesheet">
<script src="{{=URL('static','js/bootstrap-tour.min.js')}}"></script>


<script type="text/javascript" src="{{=URL('static', 'js/leader-line.min.js')}}"></script>

<title>Super Metroid VARIA Randomizer Tracker</title>

<style>
/* tutorial popup bigger for the tracker*/
.popover {
    max-width: 70%;
    max-height: 70%;
    overflow-y: scroll;
}
.main-container {
    background-color: #000;
}
.ten {
    width: 10%;
}
.ninety {
    width: 90%;
}
.map_container {
    position: relative;
}
.top {
    vertical-align: top;
}
img {
    max-width: 100%;
    height: auto;
}
.solverPopup {
    background-color: #ffffff;
    position: absolute;
    z-index: 4;
    width: 40%;
    height: auto;
    top: 2em;
    left: 30%;
    display: none;
    padding: 0.5%;
    border: 2px solid gray;
}
.cloud {
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 2%;
    left: 0%;
}
.help {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 2%;
    left: 15.5%;
}
.titleArea {
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 2%;
    left: 0%;
}
.repeatArea {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 2%;
    left: 6.5%;
}
.binArea {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 2%;
    left: 11%;
}
.titleItem {
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 6.5%;
    left: 0%;
}
.startItem {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 6.5%;
    left: 2%;
}
.repeatItem {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 6.5%;
    left: 6.5%;
}
.binItem {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 4%;
    height: 4%;
    top: 6.5%;
    left: 11%;
}
.baseButton {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 1.2210012%;
    height: 2.7472527%;
}
.baseButtonRot {
    cursor: pointer;
    position: absolute;
    z-index: 2;
    width: 1.8315018%;
    height: 1.8315018%;
}
.addBorder {
    border: 1px solid #ddd;
}
#lowerMushroomsLeft {
    left: 19.25%;
    top: 13.8%;
}
#moatRight {
    left: 49%;
    top: 7.8%;
}
#greenPiratesShaftBottomRight {
    left: 24.3%;
    top: 13.8%;
}
#keyhunterRoomBottom {
    left: 45.2%;
    top: 12.6%;
}
#morphBallRoomLeft {
    left: 29.71%;
    top: 48.8%;
}
#greenBrinstarElevatorRight {
    left: 6.25%;
    top: 29.8%;
}
#greenHillZoneTopRight {
    left: 16.8%;
    top: 64.8%;
}
#noobBridgeRight {
    left: 28.06%;
    top: 69.3%;
}
#westOceanLeft {
    left: 60.4%;
    top: 8%;
}
#crabMazeLeft {
    left: 81.3%;
    top: 15.7%;
}
#lavaDiveRight {
    left: 81.6%;
    top: 80.5%;
}
#threeMuskateersRoomLeft {
    left: 85.1%;
    top: 70%;
}
#warehouseZeelaRoomLeft {
    left: 51.1%;
    top: 64.4%;
}
#warehouseEntranceLeft {
    left: 42.35%;
    top: 67%;
}
#warehouseEntranceRight {
    left: 45.85%;
    top: 67%;
}
#singleChamberTopRight {
    left: 62.05%;
    top: 74.7%;
}
#kronicBoostRoomBottomLeft {
    left: 58.05%;
    top: 85.4%;
}
#mainStreetBottom {
    left: 67.65%;
    top: 59.3%;
}
#crabHoleBottomLeft {
    left: 71.9%;
    top: 59.3%;
}
#leCoudeRight {
    left: 90.65%;
    top: 15.1%;
}
#redFishRoomLeft {
    left: 68.2%;
    top: 44%;
}
#redTowerTopLeft {
    left: 51.3%;
    top: 51.6%;
}
#caterpillarRoomTopRight {
    left: 58.58%;
    top: 42.5%;
}
#redBrinstarElevator {
    left: 55.6%;
    top: 9.7%;
}
#eastTunnelRight {
    left: 59.7%;
    top: 59.2%;
}
#eastTunnelTopRight {
    left: 62.1%;
    top: 57.7%;
}
#glassTunnelTop {
    left: 57.6%;
    top: 56.9%;
}
#statuesHallwayLeft {
    left: 22.9%;
    top: 17.3%;
}


.marker_over_easy {
    background-image: url("/solver/static/images/marker_over_easy.png");
}
.marker_over_medium {
    background-image: url("/solver/static/images/marker_over_medium.png");
}
.marker_over_hard {
    background-image: url("/solver/static/images/marker_over_hard.png");
}
.marker_over_harder {
    background-image: url("/solver/static/images/marker_over_harder.png");
}
.marker_over_hardcore {
    background-image: url("/solver/static/images/marker_over_hardcore.png");
}
.marker_over_mania {
    background-image: url("/solver/static/images/marker_over_mania.png");
}
.marker_visited_easy {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_visited_medium {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_visited_hard {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_visited_harder {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_visited_hardcore {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_visited_mania {
    background-image: url("/solver/static/images/marker_visited.png");
}
.marker_easy {
    background-image: url("/solver/static/images/marker_easy.png");
}
.marker_medium {
    background-image: url("/solver/static/images/marker_medium.png");
}
.marker_hard {
    background-image: url("/solver/static/images/marker_hard.png");
}
.marker_harder {
    background-image: url("/solver/static/images/marker_harder.png");
}
.marker_hardcore {
    background-image: url("/solver/static/images/marker_hardcore.png");
}
.marker_mania {
    background-image: url("/solver/static/images/marker_mania.png");
}
.baseLoc {
    cursor: pointer;
    position: absolute;
    z-index: 3;
    width: 1%;
    height: 1.5%;
    background-repeat: no-repeat;
    background-size: cover;
}
.baseLocOver {
    cursor: pointer;
    position: absolute;
    z-index: 4;
    width: 2%;
    height: 3%;
    background-repeat: no-repeat;
    background-size: cover;
}

#EnergyTankGauntlet {
    left: 29.4%;
    top: 5.4%;
}
#Bomb {
    left: 37%;
    top: 11.35%;
}
#EnergyTankTerminator {
    left: 24.8%;
    top: 11.35%;
}
#ReserveTankBrinstar {
    left: 9.4%;
    top: 56.3%;
}
#ChargeBeam {
    left: 13.3%;
    top: 67.05%;
}
#MorphingBall {
    left: 34.3%;
    top: 49.45%;
}
#EnergyTankBrinstarCeiling {
    left: 39.9%;
    top: 49.45%;
}
#EnergyTankEtecoons {
    left: 2.9%;
    top: 65.6%;
}
#EnergyTankWaterway {
    left: 4.7%;
    top: 70.09%;
}
#EnergyTankBrinstarGate {
    left: 17.2%;
    top: 62.5%;
}
#XRayScope {
    left: 42.7%;
    top: 55.27%;
}
#Spazer {
    left: 57%;
    top: 58.3%;
}
#EnergyTankKraid {
    left: 50.97%;
    top: 66.8%;
}
#VariaSuit {
    left: 64.4%;
    top: 66.75%;
}
#IceBeam {
    left: 38.6%;
    top: 73.99%;
}
#EnergyTankCrocomire {
    left: 52%;
    top: 86.05%;
}
#HiJumpBoots {
    left: 40.4%;
    top: 80%;
}
#GrappleBeam {
    left: 36.65%;
    top: 95.2%;
}
#ReserveTankNorfair {
    left: 51.02%;
    top: 73.99%;
}
#SpeedBooster {
    left: 69.05%;
    top: 73.95%;
}
#WaveBeam {
    left: 61.4%;
    top: 76.9%;
}
#EnergyTankRidley {
    left: 78.35%;
    top: 92%;
}
#ScrewAttack {
    left: 76.45%;
    top: 90.4%;
}
#EnergyTankFirefleas {
    left: 2.9%;
    top: 65.6%;
}
#ReserveTankWreckedShip {
    left: 71.71%;
    top: 5.7%;
}
#EnergyTankWreckedShip {
    left: 74.7%;
    top: 7.3%;
}
#RightSuperWreckedShip {
    left: 77.4%;
    top: 13.3%;
}
#GravitySuit {
    left: 66.97%;
    top: 7.2%;
}
#EnergyTankMamaturtle {
    left: 74.93%;
    top: 52.3%;
}
#PlasmaBeam {
    left: 84.2%;
    top: 36.87%;
}
#ReserveTankMaridia {
    left: 77.55%;
    top: 56.85%;
}
#SpringBall {
    left: 89.1%;
    top: 58.4%;
}
#EnergyTankBotwoon {
    left: 85.3%;
    top: 46.2%;
}
#SpaceJump {
    left: 93.9%;
    top: 49.3%;
}
#PowerBombCrateriasurface {
    left: 44.5%;
    top: 3.9%;
}
#MissileoutsideWreckedShipbottom {
    left: 61.35%;
    top: 10.1%;
}
#MissileoutsideWreckedShiptop {
    left: 62.1%;
    top: 2.75%;
}
#MissileoutsideWreckedShipmiddle {
    left: 61.35%;
    top: 5.55%;
}
#MissileCrateriamoat {
    left: 47.5%;
    top: 8.4%;
}
#MissileCrateriabottom {
    left: 32.25%;
    top: 29.6%;
}
#MissileCrateriagauntletright {
    left: %;
    top: %;
}
#MissileCrateriagauntletleft {
    left: %;
    top: %;
}
#SuperMissileCrateria {
    left: %;
    top: %;
}
#MissileCrateriamiddle {
    left: %;
    top: %;
}
#PowerBombgreenBrinstarbottom {
    left: %;
    top: %;
}
#SuperMissilepinkBrinstar {
    left: %;
    top: %;
}
#MissilegreenBrinstarbelowsupermissile {
    left: %;
    top: %;
}
#SuperMissilegreenBrinstartop {
    left: %;
    top: %;
}
#MissilegreenBrinstarbehindmissile {
    left: %;
    top: %;
}
#MissilegreenBrinstarbehindreservetank {
    left: %;
    top: %;
}
#MissilepinkBrinstartop {
    left: %;
    top: %;
}
#MissilepinkBrinstarbottom {
    left: %;
    top: %;
}
#PowerBombpinkBrinstar {
    left: %;
    top: %;
}
#MissilegreenBrinstarpipe {
    left: %;
    top: %;
}
#PowerBombblueBrinstar {
    left: %;
    top: %;
}
#MissileblueBrinstarmiddle {
    left: %;
    top: %;
}
#SuperMissilegreenBrinstarbottom {
    left: %;
    top: %;
}
#MissileblueBrinstarbottom {
    left: %;
    top: %;
}
#MissileblueBrinstartop {
    left: %;
    top: %;
}
#MissileblueBrinstarbehindmissile {
    left: %;
    top: %;
}
#PowerBombredBrinstarsidehopperroom {
    left: %;
    top: %;
}
#PowerBombredBrinstarspikeroom {
    left: %;
    top: %;
}
#MissileredBrinstarspikeroom {
    left: %;
    top: %;
}
#MissileKraid {
    left: %;
    top: %;
}
#Missilelavaroom {
    left: %;
    top: %;
}
#MissilebelowIceBeam {
    left: %;
    top: %;
}
#MissileaboveCrocomire {
    left: %;
    top: %;
}
#MissileHiJumpBoots {
    left: %;
    top: %;
}
#EnergyTankHiJumpBoots {
    left: %;
    top: %;
}
#PowerBombCrocomire {
    left: %;
    top: %;
}
#MissilebelowCrocomire {
    left: %;
    top: %;
}
#MissileGrappleBeam {
    left: %;
    top: %;
}
#MissileNorfairReserveTank {
    left: %;
    top: %;
}
#MissilebubbleNorfairgreendoor {
    left: %;
    top: %;
}
#MissilebubbleNorfair {
    left: %;
    top: %;
}
#MissileSpeedBooster {
    left: %;
    top: %;
}
#MissileWaveBeam {
    left: %;
    top: %;
}
#MissileGoldTorizo {
    left: %;
    top: %;
}
#SuperMissileGoldTorizo {
    left: %;
    top: %;
}
#MissileMickeyMouseroom {
    left: %;
    top: %;
}
#MissilelowerNorfairabovefireflearoom {
    left: %;
    top: %;
}
#PowerBomblowerNorfairabovefireflearoom {
    left: %;
    top: %;
}
#PowerBombPowerBombsofshame {
    left: %;
    top: %;
}
#MissilelowerNorfairnearWaveBeam {
    left: %;
    top: %;
}
#MissileWreckedShipmiddle {
    left: %;
    top: %;
}
#MissileGravitySuit {
    left: %;
    top: %;
}
#MissileWreckedShiptop {
    left: %;
    top: %;
}
#SuperMissileWreckedShipleft {
    left: %;
    top: %;
}
#MissilegreenMaridiashinespark {
    left: %;
    top: %;
}
#SuperMissilegreenMaridia {
    left: %;
    top: %;
}
#MissilegreenMaridiatatori {
    left: %;
    top: %;
}
#SuperMissileyellowMaridia {
    left: %;
    top: %;
}
#MissileyellowMaridiasupermissile {
    left: %;
    top: %;
}
#MissileyellowMaridiafalsewall {
    left: %;
    top: %;
}
#MissileleftMaridiasandpitroom {
    left: %;
    top: %;
}
#MissilerightMaridiasandpitroom {
    left: %;
    top: %;
}
#PowerBombrightMaridiasandpitroom {
    left: %;
    top: %;
}
#MissilepinkMaridia {
    left: %;
    top: %;
}
#SuperMissilepinkMaridia {
    left: %;
    top: %;
}
#MissileDraygon {
    left: %;
    top: %;
}
</style>

<script type="text/javascript">
//-----------------------------------------------------------
// AREAS TRACKER

var firstClick = "";
var secondClick = "";

var lines = {};
var leaderLines = {};

var colors = ['grey', 'lime', 'pink',  'orange', 'yellow', 'purple', 'red', '#bfef45', 'white', 'cyan', 'magenta', 'olive', 'green', 'blue'];

var nextColor = 0;

var linesSeq = new Array();

function clickPortal(elemId) {
  if(firstClick == ""){
    // highlight first element
    if(! (elemId in lines)){
      firstClick = elemId;
      $("#"+firstClick).addClass("addBorder");
    }
  } else if(firstClick == elemId){
    $("#"+firstClick).removeClass("addBorder");
    firstClick = "";
  } else if(secondClick == "" && elemId != firstClick) {

    if(! ((firstClick in lines) || (elemId in lines))) {
      secondClick = elemId;

      addLine(firstClick, secondClick);

      ajaxCallArea({action: "add", startPoint: firstClick, endPoint: secondClick}, "upload");

      firstClick = "";
      secondClick = "";
    }
  }
}

function addLine(startPoint, endPoint) {
  var startPointElem = document.getElementById(startPoint);
  var endPointElem = document.getElementById(endPoint);

  var line = new LeaderLine(startPointElem, endPointElem,
                            {startPlug: 'disc',
                             endPlug: 'disc',
                             dropShadow: true,
                             startPlugColor: colors[nextColor],
                             endPlugColor: colors[nextColor],
                             size: 6,
                             gradient: true,
                             outlineColor: 'rgb(255, 255, 255)',
                             outline: true,
                             outlineSize: 0.15});

  nextColor += 1;
  $("#"+startPoint).removeClass("addBorder");

  lines[startPoint] = endPoint;
  lines[endPoint] = startPoint;

  leaderLines[startPoint] = line;
  leaderLines[endPoint] = line;

  linesSeq.push(startPoint);
}

function clearLines() {
  var result = confirm("Delete all the lines ?");
  if(result == false){
    return;
  }

  for (var startPoint in lines) {
    if(lines[startPoint] != "") {
      var endPoint = lines[startPoint];
      lines[startPoint] = "";
      lines[endPoint] = "";
      leaderLines[startPoint].remove();
      leaderLines[startPoint] = "";
      leaderLines[endPoint] = "";
    }
  }
  lines = {};
  leaderLines = {};
  linesSeq = [];
  nextColor = 0;
  ajaxCallArea({action: "clear"}, "upload");
}

function deleteLine() {
  if(linesSeq.length == 0){
    return;
  }

  var startPoint = linesSeq.pop();
  var endPoint = lines[startPoint];

  delete lines[startPoint];
  delete lines[endPoint];

  leaderLines[startPoint].remove();

  delete leaderLines[startPoint];
  delete leaderLines[endPoint];

  nextColor -= 1;
  ajaxCallArea({action: "remove"}, "upload");
}

function ajaxCallArea(dataDict, msg, okFunc=ajaxOkJSON) {
    var request = $.ajax({
      url: "{{=URL(f='areaTrackerWebService')}}",
      method: "POST",
      data: dataDict,
      dataType: "json",
      crossDomain: true
    });

    setWSIcon(msg);

    request.done(okFunc);
    request.fail(ajaxFailJSON);
}

function ajaxOkGetArea(jsonData) {
  var arrayLength = jsonData["linesSeq"].length;
  for(var i=0; i<arrayLength; i++) {
    addLine(jsonData["linesSeq"][i], jsonData["lines"][jsonData["linesSeq"][i]]);
  }

  setWSIcon("checkmark");
}

function startAnimation(elem) {
  if(elem.id in leaderLines) {
    var line = leaderLines[elem.id];
    line.dash = {animation: true};
  }
}

function stopAnimation(elem) {
  if(elem.id in leaderLines) {
    var line = leaderLines[elem.id];
    line.dash = false;
  }
}



//-----------------------------------------------------------
// COMMON

function ajaxFailJSON(jqXHR, textStatus) {
  console.log("error ["+jqXHR.responseJSON+"] ["+textStatus+"]");

  setWSIcon("warning");
}

function ajaxOkJSON(data) {
  setWSIcon("checkmark");
}

function setWSIcon(icon) {
  var names = ["checkmark", "warning", "download", "upload"];
  for(var i=0; i<names.length; i++) {
    if(names[i] == icon){
      document.getElementById(names[i]).style.display = "block";
    } else {
      document.getElementById(names[i]).style.display = "none";
    }
  }
}



//-----------------------------------------------------------
// ITEMS TRACKER

window.onload = function(){
  ajaxCallArea({action: "get"}, "download", ajaxOkGetArea);
  ajaxCallItem({action: "get"}, "download", ajaxOkGetItem);

  // display the help on first connection to the tracker
{{
  if "firstTime" in session.tracker["area"] and session.tracker["area"]["firstTime"] == True:
    session.tracker["area"]["firstTime"] = False
}}
    startTheTour(0);
{{
    pass
}}

  // TODO::to remove
  $("#MissileCrateriabottom").attr("class", "baseLoc marker_medium");

  var filesInput = document.getElementById("uploadFile");
  filesInput.addEventListener("change", function(event) {
    var files = event.target.files; //It returns a FileList object
    var file = files[0];
  
    var reader = new FileReader();
  
    reader.onload = function(e) {
  	// check sfc or smc extention
        var re = /(?:\.([^.]+))?$/;
  	var ext = re.exec(file.name)[1];
        if( ! (ext === "sfc" || ext === "smc") ) {
            document.getElementById("uploadFile").value = "";
            alert("wrong extension: "+ext);
            return false;
        }
  
        var re = /((.*)\.[^.]+)?$/;
        var base = re.exec(file.name)[1];
  
        var outFileName = file.name.replace(/\.[^/.]+$/, ".json");
  
        var fileSize = file.size;
  	if( fileSize > 4*1024*1024 ) {
            document.getElementById("uploadFile").value = "";
            alert("Wrong ROM file size: "+fileSize.toString());
            return false;
        }
  
        var bytes = new Uint8Array(e.target.result);
  
        // locations items
        var addresses = new Array(0x78264, 0x78404, 0x78432, 0x7852C, 0x78614, 0x786DE, 0x7879E, 0x787C2, 0x787FA, 0x78824, 0x78876, 0x7896E, 0x7899C, 0x78ACA, 0x78B24, 0x78BA4, 0x78BAC, 0x78C36, 0x78C3E, 0x78C82, 0x78CCA, 0x79108, 0x79110, 0x79184, 0x7C2E9, 0x7C337, 0x7C365, 0x7C36D, 0x7C47D, 0x7C559, 0x7C5E3, 0x7C6E5, 0x7C755, 0x7C7A7, 0x781CC, 0x781E8, 0x781EE, 0x781F4, 0x78248, 0x783EE, 0x78464, 0x7846A, 0x78478, 0x78486, 0x784AC, 0x784E4, 0x78518, 0x7851E, 0x78532, 0x78538, 0x78608, 0x7860E, 0x7865C, 0x78676, 0x7874C, 0x78798, 0x787D0, 0x78802, 0x78836, 0x7883C, 0x788CA, 0x7890E, 0x78914, 0x789EC, 0x78AE4, 0x78B46, 0x78BC0, 0x78BE6, 0x78BEC, 0x78C04, 0x78C14, 0x78C2A, 0x78C44, 0x78C52, 0x78C66, 0x78C74, 0x78CBC, 0x78E6E, 0x78E74, 0x78F30, 0x78FCA, 0x78FD2, 0x790C0, 0x79100, 0x7C265, 0x7C2EF, 0x7C319, 0x7C357, 0x7C437, 0x7C43D, 0x7C483, 0x7C4AF, 0x7C4B5, 0x7C533, 0x7C5DD, 0x7C5EB, 0x7C5F1, 0x7C603, 0x7C609, 0x7C74D);
        var romData = {};
  
        var arrayLength = addresses.length;
        for(var i=0; i<arrayLength; i++) {
            romData[addresses[i]] = bytes[addresses[i]];
            romData[addresses[i]+1] = bytes[addresses[i]+1];
            romData[addresses[i]+4] = bytes[addresses[i]+4];
        }
  
        // startCeres
        romData[0x7F1F] = bytes[0x7F1F];
        // startLS
        romData[0x7F17] = bytes[0x7F17];
        // layout
        romData[0x21BD80] = bytes[0x21BD80];
        // casual
        romData[0x22E879] = bytes[0x22E879];
        // gravity
        romData[0x06e37d] = bytes[0x06e37d];
        // varia tweaks
        romData[0x7CC4D] = bytes[0x7CC4D];
        // area
        romData[0x22D564] = bytes[0x22D564];
        // area layout
        romData[0x252FA7] = bytes[0x252FA7];
  
        // transitions
        var addresses = new Array(0x18c22, 0x18aea, 0x18a42, 0x18e9e, 0x18bfe, 0x18e86, 0x18f0a, 0x189ca, 0x18aae, 0x196d2, 0x19a4a, 0x1922e, 0x195fa, 0x1967e, 0x1a39c, 0x1a510, 0x18aa2, 0x1a480, 0x1902a, 0x190c6, 0x18af6, 0x1a384, 0x1a390, 0x1a330, 0x18c52, 0x191e6, 0x1913e, 0x1923a);
        var arrayLength = addresses.length;
        for(var i=0; i<arrayLength; i++) {
            romData[addresses[i]] = bytes[addresses[i]]
            romData[addresses[i]+1] = bytes[addresses[i]+1];
            romData[addresses[i]+6] = bytes[addresses[i]+6];
            romData[addresses[i]+7] = bytes[addresses[i]+7];
        }
  
        romData["romFileName"] = outFileName;
  
        var json = JSON.stringify(romData);
  
        var output = document.getElementById("romJson");
        output.value = json;
    }
  
    reader.readAsArrayBuffer(file);
  }, false);
}

// can add more variables:
//  -state: posible values: ["available", "visited"]
//  -difficulty: possible values: ["easy", "medium", "hard", "harder", "hardcore", "mania"]
//  -tooltip: {name: "xxx", item: "xxx", items: [], knows: []}
var locsInfo = {
  EnergyTankGauntlet: {left: 29.4, top: 5.4},
  Bomb: {left: 37, top: 11.35},
  EnergyTankTerminator: {left: 24.8, top: 11.35},
  ReserveTankBrinstar: {left: 9.4, top: 56.3},
  ChargeBeam: {left: 13.3, top: 67.05},
  MorphingBall: {left: 34.3, top: 49.45},
  EnergyTankBrinstarCeiling: {left: 39.9, top: 49.45},
  EnergyTankEtecoons: {left: 2.9, top: 65.6},
  EnergyTankWaterway: {left: 4.7, top: 70.09},
  EnergyTankBrinstarGate: {left: 17.2, top: 62.5},
  XRayScope: {left: 42.7, top: 55.27},
  Spazer: {left: 57, top: 58.3},
  EnergyTankKraid: {left: 50.97, top: 66.8},
  VariaSuit: {left: 64.4, top: 66.75},
  IceBeam: {left: 38.6, top: 73.99},
  EnergyTankCrocomire: {left: 52, top: 86.05},
  HiJumpBoots: {left: 40.4, top: 80},
  GrappleBeam: {left: 36.65, top: 95.2},
  ReserveTankNorfair: {left: 51.02, top: 73.99},
  SpeedBooster: {left: 69.05, top: 73.95},
  WaveBeam: {left: 61.4, top: 76.9},
  EnergyTankRidley: {left: 78.35, top: 92},
  ScrewAttack: {left: 76.45, top: 90.4},
  EnergyTankFirefleas: {left: 2.9, top: 65.6},
  ReserveTankWreckedShip: {left: 71.71, top: 5.7},
  EnergyTankWreckedShip: {left: 74.7, top: 7.3},
  RightSuperWreckedShip: {left: 77.4, top: 13.3},
  GravitySuit: {left: 66.97, top: 7.2},
  EnergyTankMamaturtle: {left: 74.93, top: 52.3},
  PlasmaBeam: {left: 84.2, top: 36.87},
  ReserveTankMaridia: {left: 77.55, top: 56.85},
  SpringBall: {left: 89.1, top: 58.4},
  EnergyTankBotwoon: {left: 85.3, top: 46.2},
  SpaceJump: {left: 93.9, top: 49.3},
  PowerBombCrateriasurface: {left: 44.5, top: 3.9},
  MissileoutsideWreckedShipbottom: {left: 61.35, top: 10.1},
  MissileoutsideWreckedShiptop: {left: 62.1, top: 2.75},
  MissileoutsideWreckedShipmiddle: {left: 61.35, top: 5.55},
  MissileCrateriamoat: {left: 47.5, top: 8.4},
  MissileCrateriabottom: {left: 32.25, top: 29.6},
  MissileCrateriagauntletright: {left: 0, top: 0},
  MissileCrateriagauntletleft: {left: 0, top: 0},
  SuperMissileCrateria: {left: 0, top: 0},
  MissileCrateriamiddle: {left: 0, top: 0},
  PowerBombgreenBrinstarbottom: {left: 0, top: 0},
  SuperMissilepinkBrinstar: {left: 0, top: 0},
  MissilegreenBrinstarbelowsupermissile: {left: 0, top: 0},
  SuperMissilegreenBrinstartop: {left: 0, top: 0},
  MissilegreenBrinstarbehindmissile: {left: 0, top: 0},
  MissilegreenBrinstarbehindreservetank: {left: 0, top: 0},
  MissilepinkBrinstartop: {left: 0, top: 0},
  MissilepinkBrinstarbottom: {left: 0, top: 0},
  PowerBombpinkBrinstar: {left: 0, top: 0},
  MissilegreenBrinstarpipe: {left: 0, top: 0},
  PowerBombblueBrinstar: {left: 0, top: 0},
  MissileblueBrinstarmiddle: {left: 0, top: 0},
  SuperMissilegreenBrinstarbottom: {left: 0, top: 0},
  MissileblueBrinstarbottom: {left: 0, top: 0},
  MissileblueBrinstartop: {left: 0, top: 0},
  MissileblueBrinstarbehindmissile: {left: 0, top: 0},
  PowerBombredBrinstarsidehopperroom: {left: 0, top: 0},
  PowerBombredBrinstarspikeroom: {left: 0, top: 0},
  MissileredBrinstarspikeroom: {left: 0, top: 0},
  MissileKraid: {left: 0, top: 0},
  Missilelavaroom: {left: 0, top: 0},
  MissilebelowIceBeam: {left: 0, top: 0},
  MissileaboveCrocomire: {left: 0, top: 0},
  MissileHiJumpBoots: {left: 0, top: 0},
  EnergyTankHiJumpBoots: {left: 0, top: 0},
  PowerBombCrocomire: {left: 0, top: 0},
  MissilebelowCrocomire: {left: 0, top: 0},
  MissileGrappleBeam: {left: 0, top: 0},
  MissileNorfairReserveTank: {left: 0, top: 0},
  MissilebubbleNorfairgreendoor: {left: 0, top: 0},
  MissilebubbleNorfair: {left: 0, top: 0},
  MissileSpeedBooster: {left: 0, top: 0},
  MissileWaveBeam: {left: 0, top: 0},
  MissileGoldTorizo: {left: 0, top: 0},
  SuperMissileGoldTorizo: {left: 0, top: 0},
  MissileMickeyMouseroom: {left: 0, top: 0},
  MissilelowerNorfairabovefireflearoom: {left: 0, top: 0},
  PowerBomblowerNorfairabovefireflearoom: {left: 0, top: 0},
  PowerBombPowerBombsofshame: {left: 0, top: 0},
  MissilelowerNorfairnearWaveBeam: {left: 0, top: 0},
  MissileWreckedShipmiddle: {left: 0, top: 0},
  MissileGravitySuit: {left: 0, top: 0},
  MissileWreckedShiptop: {left: 0, top: 0},
  SuperMissileWreckedShipleft: {left: 0, top: 0},
  MissilegreenMaridiashinespark: {left: 0, top: 0},
  SuperMissilegreenMaridia: {left: 0, top: 0},
  MissilegreenMaridiatatori: {left: 0, top: 0},
  SuperMissileyellowMaridia: {left: 0, top: 0},
  MissileyellowMaridiasupermissile: {left: 0, top: 0},
  MissileyellowMaridiafalsewall: {left: 0, top: 0},
  MissileleftMaridiasandpitroom: {left: 0, top: 0},
  MissilerightMaridiasandpitroom: {left: 0, top: 0},
  PowerBombrightMaridiasandpitroom: {left: 0, top: 0},
  MissilepinkMaridia: {left: 0, top: 0},
  SuperMissilepinkMaridia: {left: 0, top: 0},
  MissileDraygon: {left: 0, top: 0}
};

function mouseOver(elem) {
  return;
  elem.className = elem.className.replace("baseLoc", "baseLocOver");
  elem.className = elem.className.replace("marker_", "marker_over_");

  var newTop = locsInfo[elem.id].top - 0.75;
  var newLeft = locsInfo[elem.id].left - 0.5;
  $(elem).css({"top": newTop+"%", "left": newLeft+"%"});
}

function mouseOut(elem) {
  return;
  elem.className = elem.className.replace("baseLocOver", "baseLoc");
  elem.className = elem.className.replace("marker_over_", "marker_");

  var newTop = locsInfo[elem.id].top;
  var newLeft = locsInfo[elem.id].left;
  $(elem).css({"top": newTop+"%", "left": newLeft+"%"});
}

function displayPopup() {
  // display popup
  document.getElementById("solverPopup").style.display = "block";
}

function hidePopup() {
  document.getElementById("solverPopup").style.display = "none";
}

function initSolver() {
  console.log("initSolver");
  // check that romJson is set
  var romJson = document.getElementById("romJson");
  var value = romJson.value;

  if(value.length == 0){
    return;
  }

  // prepare parameters for WS
  ajaxCallItem({action: "init", romJson: value, preset: document.getElementById("preset").value}, "download", ajaxOkGetItem);

  hidePopup();
}

function clickLoc(elem) {
  // check that lock is in the available list
  var locName = elem.id;
  if("state" in locsInfo[locName] && locsInfo[locName]["state"] == "available") {
    // call webservice
    ajaxCallItem({action: "add", locName: locName}, "upload", ajaxOkGetItem);
  }
}

function deleteLoc() {
  // call webservice
  ajaxCallItem({action: "remove"}, "upload", ajaxOkGetItem);
}

function clearLocs() {
  //call webservice
  ajaxCallItem({action: "clear"}, "upload", ajaxOkGetItem);
}

function ajaxCallItem(dataDict, msg, okFunc=ajaxOkJSON) {
    var request = $.ajax({
      url: "{{=URL(f='itemTrackerWebService')}}",
      method: "POST",
      data: dataDict,
      dataType: "json",
      crossDomain: true
    });

    setWSIcon(msg);

    request.done(okFunc);
    request.fail(ajaxFailJSON);
}

function ajaxOkGetItem(jsonData) {
  // get dicts availableLocations and visitedLocations
  console.log("json received: [ "+jsonData+" ]");
  if(jsonData == "OK") {
    return;
  }

  if("availableLocations" in jsonData) {
    for(var locName in jsonData["availableLocations"]) {
      console.log(locName+" is available");
      var locData = jsonData["availableLocations"][locName];
      locsInfo[locName]["state"] = "available";
      locsInfo[locName]["difficulty"] = locData["difficulty"];
      locsInfo[locName]["tooltip"] = {name: locName, item: "?", items: locData["items"], knows: locData["knows"]};

      $("#"+locName).attr("class", "baseLoc marker_"+locData["difficulty"]);
      $("#"+locName+'[data-toggle="tooltip"]').attr("title", locName+": ?");
    }
  }
  if("visitedLocations" in jsonData) {
    for(var locName in jsonData["visitedLocations"]) {
      console.log(locName+" is visited");
      var locData = jsonData["visitedLocations"][locName];
      locsInfo[locName]["state"] = "visited";
      locsInfo[locName]["difficulty"] = locData["difficulty"];
      locsInfo[locName]["tooltip"] = {name: locName, item: locData["item"], items: locData["items"], knows: locData["knows"]};

      $("#"+locName).attr("class", "baseLoc marker_visited_"+locData["difficulty"]);
      $("#"+locName+'[data-toggle="tooltip"]').attr("title", locName+": "+locData["item"]);
    }
  }

  setWSIcon("checkmark");
}




//-----------------------------------------------------------
// TUTORIAL

function startTheTour(step=-1) {
  // the tour tutorial
  var tour = new Tour({
    storage: false,
    steps: [{
      element: "#help",
      title: "VARIA Area & Item Tracker",
      content: "<h2 class=\"center\">Welcome to the VARIA Area & Item Tracker</h2><h4>Area Tracker</h4><p>The Area Tracker allows you to track the connections between the areas portals.<br/>To use it, click on a portal <img src=\"/solver/static/images/portal.png\" alt=\"Portal\" style=\"width: 32px\">, it'll highlight it, then click on a second portal, it'll draw a line between the two portals.<br/>You can delete the latest added line with the <img src=\"/solver/static/images/repeat.svg\" alt=\"Cancel Last\" style=\"width: 32px\"> button and all of them with the <img src=\"/solver/static/images/bin.svg\" alt=\"Remove all\" style=\"width: 32px\"> button.<br/><h4>Item Tracker</h4><p>The Item Tracker allows you to use the Solver in interactive mode.<br/>To use it, click on the <img src=\"/solver/static/images/play.svg\" alt=\"Start\" style=\"width: 32px\"> button to upload your ROM and choose your preset (like on the Solver page).<br/>Then the available locations will be displayed on the map, click on a location after you've collected the item of the location in the game, it'll update the next available locations.<br/>The color of the icon on the available locations matchs the difficulty to reach the location:<ul><li><img src=\"/solver/static/images/marker_easy.png\" alt=\"easy\" style=\"width: 32px\"> easy</li><li><img src=\"/solver/static/images/marker_medium.png\" alt=\"medium\" style=\"width: 32px\"> medium</li><li><img src=\"/solver/static/images/marker_hard.png\" alt=\"hard\" style=\"width: 32px\"> hard</li><li><img src=\"/solver/static/images/marker_harder.png\" alt=\"harder\" style=\"width: 32px\"> very hard</li><li><img src=\"/solver/static/images/marker_hardcore.png\" alt=\"hardcore\" style=\"width: 32px\"> hardcore</li><li><img src=\"/solver/static/images/marker_mania.png\" alt=\"mania\" style=\"width: 32px\"> mania</li></ul>When a location has been visited its icon change to this: <img src=\"/solver/static/images/marker_visited.png\" alt=\"Visited\" style=\"width: 32px\"><br/>When overing the mouse cursor on an available or visited location a tooltip will be displayed with various information on the location.</p><h4>Auto Save</h4><p>Both trackers feature an auto save functionnality, so you can do your seed in multiple seatings.<br/>The different status icons of the auto save:<ul><li><img src=\"/solver/static/images/checkmark.svg\" style=\"width: 32px\"> Save ok</li><li><img src=\"/solver/static/images/cloud_upload.png\" style=\"width: 32px\"> Upload in progress</li><li><img src=\"/solver/static/images/cloud_download.svg\" style=\"width: 32px\"> Download in progress</li><li><img src=\"/solver/static/images/warning.svg\" style=\"width: 32px\"> Something wrong happened (try reloading the page)</li></ul></p><p>You can display this help again by clicking on the <img src=\"/solver/static/images/help.svg\" alt=\"help\" style=\"width: 32px\"> button.</p><p><h4>Thanks to</h4><ul><li>Location icons from Alli_Cat's <a href='https://github.com/allibear17/Super-Metroid-Location-Tracker'>Location Tracker</a></li><li>Action icons from <a href='https://dryicons.com/icon-packs/stylistica-icons-set'>Dryicons</a></li></ul></p>"
    }]
  });

  // Initialize the tour
  tour.init();

  // Start the tour
  if(step != -1) {
    tour.goTo(step);
  }
  tour.start();
}

</script>

<div class="fixed">
  <div class="menu">
    {{=A("Home", _href=URL(f="home"), _class="menu")}}
    {{=A("Presets", _href=URL(f="presets"), _class="menu")}}
    {{=A("Randomizer", _href=URL(f="randomizer"), _class="menu")}}
    {{=A("Solver", _href=URL(f="solver"), _class="menu")}}
    {{=A("Area Tracker", _href=URL(f="tracker"), _class="menu_selected")}}
    {{=A("Information & Contact", _href=URL(f="infos"), _class="menu")}}
  </div>
</div>

<div class="main">

  <div id="solverPopup" class="solverPopup">
    <table class="full">
      <colgroup><col class="half" /><col class="half" /></colgroup>
      <tr>
	<td>Randomized Super Metroid ROM: </td>
	<td><input id="uploadFile" name="uploadFile" type="file"/></td>
      </tr>
      <tr>
	<td>Preset:</td>
	<td>{{=SELECT(OPTGROUP(*stdPresets, **dict(_label="Standard presets")), OPTGROUP(*comPresets, **dict(_label="Community presets")), **dict(_name="preset", _id="preset", value=session.tracker["item"]["preset"], _class="filldropdown chzn-select"))}}</td>
      </tr>
      <tr>
	<td><button type="button" onclick="initSolver()" class="full">Init</button></td>
	<td><button type="button" onclick="hidePopup()" class="full">Cancel</button></td>
      </tr>
    </table>
    <input id="romJson" name="romJson" style="display:none" type="text"/>
  </div>

  <div class="map_container">
    <img id="map" src="/solver/static/images/area_map.png" class="center">
    <div id="lowerMushroomsLeft" class="baseButton" onclick="clickPortal('lowerMushroomsLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="moatRight" class="baseButton" onclick="clickPortal('moatRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="greenPiratesShaftBottomRight" class="baseButton" onclick="clickPortal('greenPiratesShaftBottomRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="keyhunterRoomBottom" class="baseButtonRot" onclick="clickPortal('keyhunterRoomBottom')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="morphBallRoomLeft" class="baseButton" onclick="clickPortal('morphBallRoomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="greenBrinstarElevatorRight" class="baseButton" onclick="clickPortal('greenBrinstarElevatorRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="greenHillZoneTopRight" class="baseButton" onclick="clickPortal('greenHillZoneTopRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="noobBridgeRight" class="baseButton" onclick="clickPortal('noobBridgeRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="westOceanLeft" class="baseButton" onclick="clickPortal('westOceanLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="crabMazeLeft" class="baseButton" onclick="clickPortal('crabMazeLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="lavaDiveRight" class="baseButton" onclick="clickPortal('lavaDiveRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="threeMuskateersRoomLeft" class="baseButton" onclick="clickPortal('threeMuskateersRoomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="warehouseZeelaRoomLeft" class="baseButton" onclick="clickPortal('warehouseZeelaRoomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="warehouseEntranceLeft" class="baseButton" onclick="clickPortal('warehouseEntranceLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="warehouseEntranceRight" class="baseButton" onclick="clickPortal('warehouseEntranceRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="singleChamberTopRight" class="baseButton" onclick="clickPortal('singleChamberTopRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="kronicBoostRoomBottomLeft" class="baseButton" onclick="clickPortal('kronicBoostRoomBottomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="mainStreetBottom" class="baseButtonRot" onclick="clickPortal('mainStreetBottom')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="crabHoleBottomLeft" class="baseButton" onclick="clickPortal('crabHoleBottomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="leCoudeRight" class="baseButton" onclick="clickPortal('leCoudeRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="redFishRoomLeft" class="baseButton" onclick="clickPortal('redFishRoomLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="redTowerTopLeft" class="baseButton" onclick="clickPortal('redTowerTopLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="caterpillarRoomTopRight" class="baseButton" onclick="clickPortal('caterpillarRoomTopRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="redBrinstarElevator" class="baseButtonRot" onclick="clickPortal('redBrinstarElevator')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="eastTunnelRight" class="baseButton" onclick="clickPortal('eastTunnelRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="eastTunnelTopRight" class="baseButton" onclick="clickPortal('eastTunnelTopRight')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="glassTunnelTop" class="baseButtonRot" onclick="clickPortal('glassTunnelTop')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>
    <div id="statuesHallwayLeft" class="baseButton" onclick="clickPortal('statuesHallwayLeft')" onmouseover="startAnimation(this)" onmouseout="stopAnimation(this)"></div>

    <div id="EnergyTankGauntlet" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="Bomb" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankTerminator" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ReserveTankBrinstar" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ChargeBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MorphingBall" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankBrinstarCeiling" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankEtecoons" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankWaterway" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankBrinstarGate" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="XRayScope" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="Spazer" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankKraid" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="VariaSuit" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="IceBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankCrocomire" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="HiJumpBoots" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="GrappleBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ReserveTankNorfair" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SpeedBooster" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="WaveBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankRidley" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ScrewAttack" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankFirefleas" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ReserveTankWreckedShip" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankWreckedShip" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="RightSuperWreckedShip" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="GravitySuit" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankMamaturtle" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PlasmaBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="ReserveTankMaridia" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SpringBall" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankBotwoon" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SpaceJump" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombCrateriasurface" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileoutsideWreckedShipbottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileoutsideWreckedShiptop" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileoutsideWreckedShipmiddle" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileCrateriamoat" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileCrateriabottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileCrateriagauntletright" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileCrateriagauntletleft" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissileCrateria" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileCrateriamiddle" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombgreenBrinstarbottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissilepinkBrinstar" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenBrinstarbelowsupermissile" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissilegreenBrinstartop" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenBrinstarbehindmissile" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenBrinstarbehindreservetank" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilepinkBrinstartop" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilepinkBrinstarbottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombpinkBrinstar" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenBrinstarpipe" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombblueBrinstar" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileblueBrinstarmiddle" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissilegreenBrinstarbottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileblueBrinstarbottom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileblueBrinstartop" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileblueBrinstarbehindmissile" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombredBrinstarsidehopperroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombredBrinstarspikeroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileredBrinstarspikeroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileKraid" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="Missilelavaroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilebelowIceBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileaboveCrocomire" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileHiJumpBoots" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="EnergyTankHiJumpBoots" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombCrocomire" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilebelowCrocomire" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileGrappleBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileNorfairReserveTank" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilebubbleNorfairgreendoor" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilebubbleNorfair" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileSpeedBooster" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileWaveBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileGoldTorizo" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissileGoldTorizo" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileMickeyMouseroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilelowerNorfairabovefireflearoom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBomblowerNorfairabovefireflearoom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombPowerBombsofshame" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilelowerNorfairnearWaveBeam" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileWreckedShipmiddle" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileGravitySuit" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileWreckedShiptop" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissileWreckedShipleft" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenMaridiashinespark" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissilegreenMaridia" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilegreenMaridiatatori" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissileyellowMaridia" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileyellowMaridiasupermissile" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileyellowMaridiafalsewall" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileleftMaridiasandpitroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilerightMaridiasandpitroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="PowerBombrightMaridiasandpitroom" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissilepinkMaridia" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="SuperMissilepinkMaridia" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>
    <div id="MissileDraygon" class="baseLoc" onmouseover="mouseOver(this)" onmouseout="mouseOut(this)" data-toggle="tooltip" title="" onclick="clickLoc(this)"></div>

    <div id="titleArea" class="titleArea">Area</div>
    <div id="repeatArea" class="repeatArea"><img src="/solver/static/images/repeat.svg" alt="Cancel Last" onclick="deleteLine()" data-toggle="tooltip" title="Remove last added"></div>
    <div id="binArea" class="binArea"><img src="/solver/static/images/bin.svg" alt="Clear" onclick="clearLines()" data-toggle="tooltip" title="Remove all"></div>

    <div id="titleItem" class="titleItem">Item</div>
    <div id="startItem" class="startItem"><img src="/solver/static/images/play.svg" alt="Start" onclick="displayPopup()" data-toggle="tooltip" title="Start the Solver"></div>
    <div id="repeatItem" class="repeatItem"><img src="/solver/static/images/repeat.svg" alt="Cancel Last" onclick="deleteLoc()" data-toggle="tooltip" title="Remove last added"></div>
    <div id="binItem" class="binItem"><img src="/solver/static/images/bin.svg" alt="Clear" onclick="clearLocs()" data-toggle="tooltip" title="Remove all"></div>

    <div id="help" class="help"><img src="/solver/static/images/help.svg" alt="Help" onclick="startTheTour(0)" data-toggle="tooltip" title="Display the help"></div>

    <div id="cloud" class="cloud">
      <img id="checkmark" src="/solver/static/images/checkmark.svg" alt="checkmark" data-toggle="tooltip" title="Web service OK">
      <img id="warning" src="/solver/static/images/warning.svg" alt="warning" style="display: none" data-toggle="tooltip" title="Web service ERROR">
      <img id="download" src="/solver/static/images/cloud_download.svg" alt="cloud_download" style="display: none" data-toggle="tooltip" title="Web service downloading">
      <img id="upload" src="/solver/static/images/cloud_upload.png" alt="cloud_upload" style="display: none" data-toggle="tooltip" title="Web service uploading">
    </div>

  </div>
</div>
